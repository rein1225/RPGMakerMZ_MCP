# RPGツクールMZ MCPサーバー 使用方法

このMCPサーバーは、AIアシスタント（Antigravityなど）があなたのRPGツクールMZプロジェクトを直接操作・編集できるようにするためのツールです。

## 準備するもの

1.  **Node.js**: プログラムを動かすためのソフトです。まだ入っていない場合はインストールしてください。
2.  **RPGツクールMZのプロジェクト**: `game.rmmzproject` というファイルが入っているフォルダです。

## インストール方法

このフォルダ（`RPGツクールMZ＿MCP`）で、以下のコマンドを実行して必要なプログラムをダウンロードします。

```bash
npm install
```

## 使い方

### 1. サーバーの起動

以下のコマンドでサーバーを起動できます。ただし、通常はAIアシスタントの設定ファイルに記述して自動的に起動させます。

```bash
node index.js
```

### 2. AIアシスタント（MCPクライアント）の設定

AIアシスタント（Claude Desktopなど）の設定ファイルに、このサーバーを登録する必要があります。

**設定例 (claude_desktop_config.json):**

```json
{
  "mcpServers": {
    "rpg-maker-mz": {
      "command": "node",
      "args": [
        "c:/Users/1225s/Desktop/dev/RPGMakerMZ_MCP/index.js"
      ],
      "cwd": "c:/Users/1225s/Desktop/dev/RPGMakerMZ_MCP"
    }
  }
}
```
※ パスは実際の配置場所に合わせて調整してください。

## 利用可能な機能（ツール一覧）

このサーバーを使うと、AIアシスタントは以下のことができます。

### 📂 基本操作・情報取得
*   **`get_project_info`**: ゲームタイトル、バージョン、通貨単位などを確認します。
*   **`list_data_files`**: `data` フォルダ内のJSONファイル一覧を取得します。
*   **`read_data_file`**: データファイル（例：`Actors.json`）の中身を読み込みます。
*   **`write_data_file`**: データファイルに直接書き込みを行います（上級者向け）。
*   **`list_assets`**: 画像(`img`)や音声(`audio`)素材の一覧を取得します。

### 🧩 プラグイン管理
*   **`write_plugin_code`**: 新しいプラグイン（.jsファイル）を作成・保存します。
*   **`get_plugins_config`**: 現在のプラグイン設定一覧を取得します。
*   **`update_plugins_config`**: プラグインのON/OFFやパラメータ設定を更新します。

### 🎬 イベント編集（マップ・コモンイベント）
*   **`search_events`**: 全マップ・コモンイベントから、特定のセリフやスイッチIDなどを検索します。
*   **`get_event_page`**: 特定のイベントページのコマンドリストを読みやすい形式で取得します。
*   **`add_dialogue`**: 「文章の表示」コマンドを簡単に追加します。顔グラフィックや位置も指定可能。
*   **`add_conditional_branch`**: 「条件分岐」ブロック（If-Else-End）を追加します。
*   **`add_loop` / `add_break_loop`**: 「ループ」「ループの中断」コマンドを追加します。
*   **`delete_event_command`**: イベントコマンドを削除します。
*   **`update_event_command`**: 既存のイベントコマンドの内容を更新します。

### 🗃️ データベース管理
*   **`add_actor`**: 新しいアクター（キャラクター）を追加します。
*   **`add_item`**: 新しいアイテムを追加します。
*   **`add_skill`**: 新しいスキルを追加します。

### 🗺️ マップ編集
*   **`draw_map_tile`**: 指定した座標・レイヤーにタイルを配置します。

### 🎮 テストプレイ・自動化
*   **`run_playtest`**: ゲーム(`Game.exe`)を起動し、指定時間後にスクリーンショットを撮影してAIに送信します。
    *   `autoClose: true` で撮影後に自動終了可能。
    *   `startNewGame: true` でタイトル画面をスキップしてニューゲームを開始可能。
*   **`inspect_game_state`**: 起動中のゲームから変数やスイッチの値を取得・評価します（要デバッグポート接続）。

## 注意点

*   **バックアップ推奨**: AIがデータを書き換える際、予期せぬ変更が起きる可能性があります。重要な作業の前にはプロジェクトのバックアップを取ることを強くお勧めします。
*   **パスの指定**: ツールを使用する際は、プロジェクトの絶対パス（フォルダの場所）を正しくAIに伝えてください。
*   **Game.exe**: テストプレイ機能を使用するには、プロジェクトフォルダ内に `Game.exe` が必要です（デプロイメント済み、またはエディタから起動可能な状態）。

## 自動テストプレイのデモ

このプロジェクトには、自動テスト機能を検証するためのデモスクリプトが含まれています。

**実行方法:**
```bash
node automation_demo.js
```
※ `test_project` フォルダを使用します。
